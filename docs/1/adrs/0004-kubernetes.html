<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ADR 0004: Deployment Infrastructure as code (IaC) :: Expense Tracker Docs</title>
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
    <nav class="navbar">
        <div class="navbar-brand">
            <a class="navbar-item" href="../../..">Expense Tracker Docs</a>
                <div class="navbar-item search hide-for-print">
                    <div id="search-field" class="field">
                        <input id="search-input" type="text" placeholder="Search the docs">
                    </div>
                </div>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
            <!--<div class="navbar-end">
              <a class="navbar-item" href="#">Home</a>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="#">Products</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="#">Product A</a>
                  <a class="navbar-item" href="#">Product B</a>
                  <a class="navbar-item" href="#">Product C</a>
                </div>
              </div>
              <div class="navbar-item has-dropdown is-hoverable">
                <a class="navbar-link" href="#">Services</a>
                <div class="navbar-dropdown">
                  <a class="navbar-item" href="#">Service A</a>
                  <a class="navbar-item" href="#">Service B</a>
                  <a class="navbar-item" href="#">Service C</a>
                </div>
              </div>
              <div class="navbar-item">
                <span class="control">
                  <a class="button is-primary" href="#">Download</a>
                </span>
              </div>
            </div>-->
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="docs" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Docs</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mvp.html">MVP for expense-tracker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tools.html">Tools for expense-tracker</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../commit-message-format.html">Commit message format</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Architecture Decision Records</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="0001-gradle-multi-project.html">ADR 0001: Create single multi-project Gradle build</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="0002-database-and-libraries.html">ADR 0002: Use Postgres and jOOQ</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="0003-oauth.html">ADR 0003: Use Keycloak for Identity and Access Management (IAM)</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="0004-kubernetes.html">ADR 0004: Deployment Infrastructure as code (IaC)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../diagram.html">Component diagram</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../deployment_diagram.html">Deployment diagram (DEV)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Unlisted Pages</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Docs</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">Docs</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Docs</a></li>
    <li>Architecture Decision Records</li>
    <li><a href="0004-kubernetes.html">ADR 0004: Deployment Infrastructure as code (IaC)</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/KTRI-Industries/expense-tracker-docs/edit/main/docs/modules/ROOT/pages/adrs/0004-kubernetes.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">ADR 0004: Deployment Infrastructure as code (IaC)</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Date: 2023-07-21</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_status"><a class="anchor" href="#_status"></a>Status</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Proposed</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_context"><a class="anchor" href="#_context"></a>Context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The decision has already been made to deploy the project in a Kubernetes environment.
This provides the flexibility to not have to decide too soon on what cloud provider to deploy (or even if we should just deploy in a IaaS provider).</p>
</div>
<div class="paragraph">
<p>Having decided that, there is a need for all infrastructure pieces to be deployed using code/scripts.
There are various solutions available, which can be categorised as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Code based solutions</p>
</li>
<li>
<p>Yaml based solutions</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the first category there are tools like Pulumi and cdk8s.</p>
</div>
<div class="paragraph">
<p>These tools provide libraries in Java or Typescript so the configuration is written in code and Kubernetes yaml manifests are generated from it, with all the advantages that this provides (e.g. autocomplete, refactoring, testing etc).</p>
</div>
<div class="paragraph">
<p>In the second category there are tools like Helm and Kustomize.</p>
</div>
<div class="paragraph">
<p>These tools provide a way to dynamically create Kubernetes yaml manifests, each with their own mechanisms and syntax (templates or overlays).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_decision"><a class="anchor" href="#_decision"></a>Decision</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Helm will be used mainly because it is an established and popular tool.
Helm will be used as a package manager too, so it makes sense to use it for configuring all the infrastructure components in a unified way.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consequences"><a class="anchor" href="#_consequences"></a>Consequences</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Helm charts structure needs some getting used too, especially when dealing with indentations and white spaces.</p>
</div>
<div class="paragraph">
<p>Using Helm provides a more unified lifecycle support (like versioning, rolling updates, rollback etc.).</p>
</div>
<div class="paragraph">
<p>Furthermore, Helm provides specific way to deploy to multiple environments, which is a must-have for the project.</p>
</div>
<div class="paragraph">
<p>Finally, not using a code based tool means that we will not have the flexibility that IaC provides.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
